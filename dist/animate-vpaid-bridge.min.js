require=function e(t,i,n){function r(a,s){if(!i[a]){if(!t[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(o)return o(a,!0);var d=new Error("Cannot find module '"+a+"'");throw d.code="MODULE_NOT_FOUND",d}var l=i[a]={exports:{}};t[a][0].call(l.exports,function(e){var i=t[a][1][e];return r(i?i:e)},l,l.exports,e,t,i,n)}return i[a].exports}for(var o="function"==typeof require&&require,a=0;a<n.length;a++)r(n[a]);return r}({1:[function(e,t,i){"use strict";t.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected a string");e=e.replace(/^#/,""),3===e.length&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]);var t=parseInt(e,16);return[t>>16,t>>8&255,255&t]}},{}],2:[function(e,t,i){function n(){}n.prototype={on:function(e,t,i){var n=this.e||(this.e={});return(n[e]||(n[e]=[])).push({fn:t,ctx:i}),this},once:function(e,t,i){function n(){r.off(e,n),t.apply(i,arguments)}var r=this;return n._=t,this.on(e,n,i)},emit:function(e){var t=[].slice.call(arguments,1),i=((this.e||(this.e={}))[e]||[]).slice(),n=0,r=i.length;for(n;n<r;n++)i[n].fn.apply(i[n].ctx,t);return this},off:function(e,t){var i=this.e||(this.e={}),n=i[e],r=[];if(n&&t)for(var o=0,a=n.length;o<a;o++)n[o].fn!==t&&n[o].fn._!==t&&r.push(n[o]);return r.length?i[e]=r:delete i[e],this}},t.exports=n},{}],3:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(){this._destroyed=!0,this._videoSlot.src="",this._slot.innerHTML="",this._ui=null}function s(e,t){e.width=t[0],e.height=t[1],e.style&&(e.style.width=t[0]+"px",e.style.height=t[1]+"px")}var u=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=e("tiny-emitter"),l=e("./vpaid-methods.json"),c=e("./video-tracker");t.exports=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];n(this,t);var i=r(this,Object.getPrototypeOf(t).call(this));return i.emitVpaidMethodInvocations(),i._ui={},i.quartileIndexEmitted=-1,i.hasEngaged=!1,i._attributes={companions:"",desiredBitrate:256,duration:30,remainingTime:-1,expanded:!1,icons:!1,linear:!0,adSkippableState:!1,viewMode:"normal",width:0,height:0,volume:1},i.previousAttributes=Object.assign({},i._attributes),i._options=e,i._options.videos=i._options.videos||[],i}return o(t,e),u(t,[{key:"set",value:function(e,t){this.previousAttributes[e]=this._attributes[e],this._attributes[e]=t}},{key:"handshakeVersion",value:function(e){return"2.0"}},{key:"initAd",value:function(e,t,i,n,r,o){var a=this;return this._attributes.width=e,this._attributes.height=t,this._attributes.viewMode=i,this._attributes.desiredBitrate=n,this._slot=o.slot,this._videoSlot=o.videoSlot,this._videoSlot?this._slot?(s(this._videoSlot,[this._attributes.width,this._attributes.height]),this.setSupportedVideo(this._options.videos).then(function(){a.emit("AdLoaded")}).catch(function(e){a.emit("AdLog",e),a.emit("AdLoaded")}),void(this.videoTracker=new c(this._videoSlot,this))):this.emit("AdError","Slot is invalid"):this.emit("AdError","Video slot is invalid")}},{key:"setVideoSource",value:function(e,t){var i=this;return new Promise(function(n,r){"undefined"==typeof i._videoSlot.onloadeddata?n():i._videoSlot.onloadeddata=function(){n()},i._videoSlot.onerror=function(i){var n=void 0;switch(i.target.error.code){case i.target.error.MEDIA_ERR_ABORTED:n="You aborted the video playback.";break;case i.target.error.MEDIA_ERR_NETWORK:n="A network error caused the video download to fail part-way.";break;case i.target.error.MEDIA_ERR_DECODE:n="The video playback was aborted due to a corruption problem or because the video used features your browser did not support.";break;case i.target.error.MEDIA_ERR_SRC_NOT_SUPPORTED:n="The video could not be loaded, either because the server or network failed or because the format is not supported.";break;default:n="An unknown error occurred."}r(n+" Type: "+t+", source: "+e)},i._videoSlot.src=e,i._videoSlot.type=t})}},{key:"getSupportedVideos",value:function(e){var t=document.createElement("video");return e.filter(function(e){return t.canPlayType(e.type)})}},{key:"setSupportedVideo",value:function(e){var t=this;return new Promise(function(i,n){var r=t.getSupportedVideos(e);r[0]?t.setVideoSource(r[0].url,r[0].type).then(function(){i()}).catch(function(e){n(e)}):n("no supported video found")})}},{key:"startAd",value:function(){var e=this;"undefined"==typeof this._videoSlot.onloadeddata?this.emit("AdStarted"):this._videoSlot.onloadeddata=function(){e.emit("AdStarted")},this._videoSlot.load()}},{key:"stopAd",value:function(){this._destroyed||(a.call(this),this.emit("AdStopped"))}},{key:"skipAd",value:function(){if(!this._destroyed){if(!this._attributes.adSkippableState)return!1;a.call(this),this.emit("AdSkipped"),this.emit("AdStopped")}}},{key:"resizeAd",value:function(e,t,i){this._attributes.width=e,this._attributes.height=t,this._attributes.viewMode=i,this.emit("AdSizeChange")}},{key:"pauseAd",value:function(){this._videoSlot.pause(),this.emit("AdPaused")}},{key:"resumeAd",value:function(){this._videoSlot.play(),this.emit("AdPlaying")}},{key:"expandAd",value:function(){this.hasEngaged=!0,this.set("expanded",!0),this.emit("AdExpandedChange")}},{key:"collapseAd",value:function(){this.set("expanded",!1),this.emit("AdExpandedChange")}},{key:"subscribe",value:function(e,t,i){this.on(t,e,i)}},{key:"unsubscribe",value:function(e,t){this.off(t,e)}},{key:"getAdLinear",value:function(){return this._attributes.linear}},{key:"getAdWidth",value:function(){return this._attributes.width}},{key:"getAdHeight",value:function(){return this._attributes.height}},{key:"getAdExpanded",value:function(){return this._attributes.expanded}},{key:"getAdadSkippableState",value:function(){return this._attributes.adSkippableState}},{key:"getAdRemainingTime",value:function(){return this.hasEngaged?-2:this._videoSlot.duration-this._videoSlot.currentTime}},{key:"getAdDuration",value:function(){return this.hasEngaged?-2:this._videoSlot.duration}},{key:"getAdSkippableState",value:function(){return this._attributes.adSkippableState}},{key:"getAdVolume",value:function(){return this._attributes.volume}},{key:"getAdCompanions",value:function(){return this._attributes.companions}},{key:"getAdIcons",value:function(){return this._attributes.icons}},{key:"setAdVolume",value:function(e){if(this.previousAttributes.volume!==e){if(e<0||e>1)return this.emit("AdError","volume is not valid");this.set("volume",e),this._videoSlot.volume=e,this.emit("AdVolumeChange")}}},{key:"emitVpaidMethodInvocations",value:function(){var e=this;l.forEach(function(t){var i=e[t];e[t]=function(){for(var n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];return e.emit.apply(e,[t+"()"].concat(r)),i.apply(e,r)}},this)}}]),t}(d)},{"./video-tracker":4,"./vpaid-methods.json":6,"tiny-emitter":2}],4:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=e("./vpaid-life-cycle"),a=[{value:0,name:o[0]},{value:.25,name:o[1]},{value:.5,name:o[2]},{value:.75,name:o[3]}];t.exports=function(){function e(t,i){var r=arguments.length<=2||void 0===arguments[2]?"AdVideo":arguments[2];n(this,e),this.el=t,this.emitter=i,this.prefix=r,this.quartileIndexEmitted=-1,this.el.addEventListener("timeupdate",this.handleTimeupdate.bind(this)),this.el.addEventListener("ended",this.handleEnded.bind(this))}return r(e,[{key:"emit",value:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=this.prefix+t[0];return this.emitter.emit.apply(this.emitter,[n].concat(t.splice(1)))}},{key:"handleTimeupdate",value:function(){var e=this.quartileIndexEmitted+1,t=a[e];t&&this.el.currentTime/this.el.duration>t.value&&(this.emit(t.name),this.quartileIndexEmitted=e)}},{key:"handleEnded",value:function(){this.emit(o[4]),this.el.removeEventListener("timeupdate",this.handleTimeupdate),this.el.removeEventListener("ended",this.handleEnded)}}]),e}()},{"./vpaid-life-cycle":5}],5:[function(e,t,i){"use strict";t.exports=["Start","FirstQuartile","Midpoint","ThirdQuartile","Complete"]},{}],6:[function(e,t,i){t.exports=["handshakeVersion","initAd","startAd","stopAd","skipAd","resizeAd","pauseAd","resumeAd","expandAd","collapseAd","getAdLinear","getAdWidth","getAdHeight","getAdExpanded","getAdadSkippableState","getAdRemainingTime","getAdDuration","getAdVolume","getAdCompanions","getAdIcons","setAdVolume"]},{}],7:[function(e,t,i){"use strict";function n(e,t){var i=document.createElement("script");return i.src=e,i.type="text/javascript",i.onload=t,i}Object.defineProperty(i,"__esModule",{value:!0}),i.default=n},{}],"animate-vpaid-bridge":[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function e(e,t){var i=[],n=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(i.push(a.value),!t||i.length!==t);n=!0);}catch(e){r=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw o}}return i}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},l=e("./util/createScript"),c=n(l),h=e("../node_modules/vpaid-ad/src/linear"),p=e("hex-rgb"),f=function(e){function t(e){r(this,t);var i=o(this,Object.getPrototypeOf(t).call(this,e));return i.bridgeId=e.bridgeId,i.createjsUri=e.createjsUri,i.animateJs=e.animateJs,i.basePath=e.basePath,i.once("AdStarted",function(){i._videoSlot.play()}),i}return a(t,e),u(t,[{key:"initAd",value:function(e,i,n,r,o,a){var s=this;this._attributes.width=e,this._attributes.height=i,this._attributes.viewMode=n,this._attributes.desiredBitrate=r,this._slot=a.slot,this._videoSlot=a.videoSlot,this.renderSlot_(function(){s.canvas=document.getElementById("canvas"),s.images=images||{},s.loader=new createjs.LoadQueue(!1,s.basePath),s.loader.addEventListener("fileload",s.handleFileLoad.bind(s)),s.loader.addEventListener("complete",function(e){s.handleComplete(e)}),d(Object.getPrototypeOf(t.prototype),"initAd",s).call(s,e,i,n,r,o,a),0===lib.properties.manifest.length?s.initStage():s.loader.loadManifest(lib.properties.manifest)})}},{key:"handleFileLoad",value:function(e){"image"==e.item.type&&(images[e.item.id]=e.result)}},{key:"initStage",value:function(){this.exportRoot=new lib[this.bridgeId];var e=p(lib.properties.color),t=s(e,3),i=t[0],n=t[1],r=t[2];this.canvas.style.backgroundColor="rgba("+i+", "+n+", "+r+", "+lib.properties.opacity,console.log(this.canvas.style.backgroundColor),this.stage=new createjs.Stage(this.canvas),this.exportRoot.__elan__=this,this.stage.addChild(this.exportRoot),this.stage.enableMouseOver(),createjs.Ticker.setFPS(lib.properties.fps),createjs.Ticker.addEventListener("tick",this.stage),this.resizeCanvas(!1,"both",!1,1)}},{key:"handleComplete",value:function(e){for(var t=e.target,i=lib.ssMetadata,n=0;n<i.length;n++)ss[i[n].name]=new createjs.SpriteSheet({images:[t.getResult(i[n].name)],frames:i[n].frames});this.initStage()}},{key:"resizeCanvas",value:function(e,t,i,n){var r=lib.properties.width,o=lib.properties.height,a=window.innerWidth,s=window.innerHeight,u=window.devicePixelRatio,d=a/r,l=s/o,c=1;e&&("width"===t&&this.lastW==a||"height"===t&&this.lastH==s?c=this.lastS:i?1===n?c=Math.min(d,l):2===n&&(c=Math.max(d,l)):(a<r||s<o)&&(c=Math.min(d,l))),this.canvas.width=r*u*c,this.canvas.height=o*u*c,this.canvas.style.width=r*c+"px",this.canvas.style.height=o*c+"px",this.stage.scaleX=u*c,this.stage.scaleY=u*c,this.lastW=a,this.lastH=s,this.lastS=c}}]),t}(h);i.default=f,f.prototype.renderSlot_=function(e){var t=this,i=this._slot&&"DIV"===this._slot.tagName,n=(0,c.default)(this.createjsUri,function(){i||(t._slot=document.createElement("div"),document.body||(document.body=document.createElement("body")),document.body.appendChild(t._slot)),t._slot.innerHTML='\n      <canvas id="canvas" width="550" height="400"></canvas>\n    ';var n=(0,c.default)(t.animateJs,function(){e()});document.body.appendChild(n)});document.body.appendChild(n)}},{"../node_modules/vpaid-ad/src/linear":3,"./util/createScript":7,"hex-rgb":1}]},{},[]);